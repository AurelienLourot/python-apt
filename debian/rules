#!/usr/bin/make -f
# Should be include-links, but that somehow fails.
export DH_PYCENTRAL=nomove
export DEBVER=$(shell dpkg-parsechangelog | sed -n -e 's/^Version: //p')
export CFLAGS=-Wno-write-strings -DCOMPAT_0_7

%:
	dh --with python-central $@

override_dh_auto_build:
	dh_auto_build
	python setup.py build_sphinx

override_dh_installdocs:
	dh_installdocs
	rm -rf debian/python-apt-dbg/usr/share/doc/python-apt-dbg
	ln -s python-apt debian/python-apt-dbg/usr/share/doc/python-apt-dbg

override_dh_strip:
	dh_strip --dbg-package=python-apt-dbg
	
override_dh_compress:
	dh_compress -X.js -X_static/* -X _sources/* -X_sources/*/* -X.inv

override_dh_auto_test:
	set -e; for python in $(shell pyversions -r); do \
		$$python tests/test_all.py -q; \
	done;

override_dh_pycentral:
	dh_pycentral --exclude=migrate-0.8.py
